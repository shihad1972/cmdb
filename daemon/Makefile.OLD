#
#
# Makefile for CMDBD c programs
#
#

CC = gcc
RM = rm -f
override CFLAGS := -ansi -std=c99 -pedantic -O0 -W -Wall -Wconversion -Wshadow -Wcast-qual -Wwrite-strings -Wunused -g -D_GNU_SOURCE
LDFLAGS = -L../lib/ -L/usr/lib/mysql -L/usr/lib/x86_64-linux-gnu
override CPPFLAGS := -I../src/ -I../include/ -I/usr/include/mysql -I/usr/include/uuid `libgcrypt-config --cflags`
LDLIBS = `libgcrypt-config --libs` -lailsasql -lailsacmdb -lpcre -lmysqlclient -lsqlite3 -luuid
bin_PROGRAMS = ailsa
sbin_PROGRAMS = cmdbd cmdbc

SOBJECTS = client_info.o
CDOBJECTS = cmdbd.o
COBJECTS = cmdbc.o
AOBJECTS = ailsa.o conversion.o fileio.o
DBOBJECTS = ../src/errors.o

all:	$(sbin_PROGRAMS) $(bin_PROGRAMS)
cmdbd:	$(SOBJECTS) $(CDOBJECTS)
cmdbc:	$(COBJECTS) $(SOBJECTS)

$(sbin_PROGRAMS):
	$(LINK.o) $@.o $(SOBJECTS)  $(LDLIBS) -o $@

ailsa:	$(AOBJECTS) $(DBOBJECTS)
	$(LINK.o) $(AOBJECTS) $(DBOBJECTS)  $(LDLIBS) -o $@

.PHONY:	clean

clean:
	$(RM) *.o $(sbin_PROGRAMS) $(bin_PROGRAMS)

